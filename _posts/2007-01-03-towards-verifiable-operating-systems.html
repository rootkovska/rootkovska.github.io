---
layout: post
title: Towards Verifiable Operating Systems
date: '2007-01-03T17:43:00.001+01:00'
author: Joanna Rutkowska
tags: 
modified_time: '2009-03-25T16:08:17.830+01:00'
blogger_id: tag:blogger.com,1999:blog-24586388.post-208658744926357906
blogger_orig_url: http://theinvisiblethings.blogspot.com/2007/01/towards-verifiable-operating-systems.html
---

Last week I gave a presentation at the <a href="http://events.ccc.de/congress/2006/Home">23rd Chaos Communication Congress</a> in Berlin. Originally the presentation was supposed to be titled "Stealth malware - can good guys win?", but in the very last moment I decided to redesign it completely and gave it a new title: "Fighting Stealth Malware â€“ Towards Verifiable OSes". You can download it from  <a href="http://invisiblethings.org/papers/towards_verifiable_systems.ppt">here</a>.<br /><br />The presentation first debunks The 4 Myths About Stealth Malware Fighting that surprisingly many people believe in. Then <a href="http://theinvisiblethings.blogspot.com/2006/11/introducing-stealth-malware-taxonomy.html">my stealth malware classification</a> is briefly described, presenting the malware of type 0, I and II and challenges with their detection (mainly with type II). Finally I talk about what changes into the OS design are needed to make our systems <span style="font-style:italic;">verifiable</span>. If the OS were designed in such a way, then detection of type I and type II malware would be a trivial task...<br /><br />There are only four requirements that an OS must satisfy to become easily verifiable, these are:<br /><ol><li> The underlying processors must support non-executable attribute on a per-page level,</li><br /><li>OS design must maintain strong code and data separation on a per-page level (this could be first only in kernel and later might be extended to include sensitive applications),</li><br /><li>All code sections should be verifiable on a per-page level (usually this means some signing or hashing scheme implemented),</li><br /><li>OS must allow to safely read physical memory by a 3rd party application (kernel driver/module) and for each page allow for reliable determination whether it is executable or not.</li></ol><br />The first three requirements are becoming more and more popular these days in various operating systems, as a side effect of introducing anti-exploitation/anti-malware technologies (which is a good thing, BTW). However, the 4th requirement presents a big challenge and it is not clear now whether it would be feasible on some architectures.<br /><br />Still, I think that it's possible to redesign our systems in order to make them verifiable. If we don't do that, then we will always have to rely on a bunch of "hacks" to check for some <span style="font-style:italic;">known</span> rootktis and we will be taking part in endless arm race with the bad guys. On the other hand, such situation is very convenient for the security vendors, as they can always improve their "Advanced Rootkit Detection Technology" and sell some updates... ;)<br /><br />Happy New Year!