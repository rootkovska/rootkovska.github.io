---
layout: post
title: Thoughts About Trusted Computing
date: '2009-05-28T00:58:00.004+02:00'
author: Joanna Rutkowska
tags:
- trusted computing
- philosophical
modified_time: '2009-08-01T19:36:41.267+02:00'
blogger_id: tag:blogger.com,1999:blog-24586388.post-6453215149663280165
blogger_orig_url: http://theinvisiblethings.blogspot.com/2009/05/thoughts-about-trusted-computing.html
---

<a href="http://invisiblethingslab.com/resources/misc09/trusted_computing_thoughts.pdf">Here</a> are the slides about Trusted Computing I used for my presentations at the <a href="http://eusecwest.com/agenda.html">EuSecWest</a> today, and at the <a href="http://2009.confidence.org.pl/agenda">Confidence</a> conference last week.<br /><br />As this was supposed to be a keynote, the slides are much less technical then our other slides, and also there are no new attacks presented there. Still, I hope they might be useful as some sort of an "alternative" introduction to Trusted Computing :)<br /><br />A cool presentation I saw today was about <a href="http://eusecwest.com/agenda.html">PCI-based backdoors</a> by Christophe Devine and Guillaume Vissian. They basically took a general-purpose FPGA programmable PC-card (AKA PCMCIA), flashed it with an FPGA "program" that implemented a simple state machine. The purpose of the state machine was to wait until its DMA engine gets initialized and then to modify certain bytes in the host memory, that happened to be part of the winlogon.exe process (IIRC they changed <span style="font-size:85%;"><span style="font-family: courier new;">XOR AL, AL</span></span> into <span style="font-size:85%;"><span style="font-family: courier new;">MOV AL, 1</span></span>, or something like that, at the end of some password verification function inside the winlogon.exe process). The slides should be available soon on the conference website. I also hope they will publish all the source code needed to flash your own personal "winlogon unlocker".<br /><br />The live demo was really impressive — they showed a winlogon screen, tried to login a few times with wrong passwords, of course all the attempts failed, then they inserted their magic, $300 worth, PC-card, and… 2 seconds later they could log in using any password they wanted.<br /><br />While not necessary being a breakthrough, as everybody has known such things could be done for years, I think it is still important that somebody eventually implemented this, discussed the technical details (FPGA-related), and also showed how to implement it with a cheap generic "reflashable" hardware without using a soldering iron.<br /><br />Of course I have also discussed in my presentation how to prevent PCI-based backdoors (like the one discussed here) using VT-d, but this defense is currently only available if you use Xen 3.3 or later, and also requires that you manually create driver domain partitions and come up with a reasonable scheme for assigning devices to driver domains. All in all 99.9% of users are not (and will not be anytime soon) protected against such attacks. Oh, wait, there is actually a relatively simple software-based workaround (besides putting a glue into your PC-card slot, which is not a very subtle one)… I wonder who else will find out :)