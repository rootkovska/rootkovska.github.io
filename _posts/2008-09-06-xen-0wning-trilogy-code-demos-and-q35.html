---
layout: post
title: 'Xen 0wning Trilogy: code, demos and q35 attack details posted'
date: '2008-09-06T13:59:00.001+02:00'
author: Joanna Rutkowska
tags:
- hypervisor rootkits
- xen hacking
- xen heap exploiting
- virtualization based rootkits
modified_time: '2009-03-25T16:01:52.715+01:00'
blogger_id: tag:blogger.com,1999:blog-24586388.post-7367970431147576824
blogger_orig_url: http://theinvisiblethings.blogspot.com/2008/09/xen-0wning-trilogy-code-demos-and-q35.html
---

We have posted all the code that we used last month during <a href="/2008/07/07/0wning-xen-in-vegas.html">our Black Hat presentations</a> about Xen security, and you can get it <a href="http://invisiblethingslab.com/bh08/">here</a>. This includes the full source code for:<br />1) The generic Xen Loadable Modules framework<br />2) Implementation of the two Xen Hypervisor Rootkits<br />3) The Q35 exploit<br />4) The FLASK heap overflow exploit<br />5) The BluePillBoot (with nested virtualization support on SVM)<br />6) The XenBluePill (with nested virtualization support on SVM)<br /><br />Beware the code is by far not user-friendly, it requires advanced Linux/Xen, C and system-level programming skills in order to tweak some constants and run it successfully on your system. Do not send us questions how to compile/run it, as we don’t have time to answer such questions. Also do not send questions how the code works – if you can’t figure it out by reading our slides and the source code, then it means you should probably spend more time on this yourself. On the other hand, we would appreciate any constructive feedback.<br /><br />The code is our gift to the research community. There is no warranty and Invisible Things Lab takes no responsibility for any potential damage that this code might cause (e.g. by rebooting your machine) or any potential malicious usage of this code, or any other code built on top of this code. We believe that by publishing this code we help to create more secure systems in the future.<br /><br />Additionally, we also posted the full version of our second Black Hat talk, which now includes all the slides about the Q35 bug and how we exploited it. Those slides had to be previously removed during our Black Hat presentation, as <a href="/2008/08/26/intel-patches-q35-bug.html">the patch</a> was still unavailable during that time.