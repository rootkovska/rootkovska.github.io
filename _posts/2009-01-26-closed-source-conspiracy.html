---
layout: post
title: Closed Source Conspiracy
date: '2009-01-26T17:56:00.004+01:00'
author: Joanna Rutkowska
tags:
- philosophical
modified_time: '2009-03-19T22:19:30.493+01:00'
blogger_id: tag:blogger.com,1999:blog-24586388.post-5520926602674392865
blogger_orig_url: http://theinvisiblethings.blogspot.com/2009/01/closed-source-conspiracy.html
---

Many people in the industry have an innate fear of closed source (AKA proprietary software), which especially applies to everything crypto-related.<br /><br />The usual arguments go this way: this (proprietary) crypto software is bad, because the vendor might have put some backdoors in there. And: only the open source crypto software, which can be reviewed by anyone, can be trusted! So, after my <a href="http://theinvisiblethings.blogspot.com/2009/01/why-do-i-miss-microsoft-bitlocker.html">recent post</a>, quite a few people wrote to me and asked how I could defend such an evil thing as BitLocker, which is proprietary, and, even worse, comes from Microsoft?<br /><br />I personally think this way of reasoning sucks. In majority of cases, the fact something is distributed without the accompanying source code does not prevent others from analyzing the code. We do have advanced disassemblers and debuggers, and it is really not that difficult to make use of them as many people think.<br /><br />Of course, some heavily obfuscated programs can be extremely difficult to analyze. Also, analyzing a chipset's firmware, when you do not even know the underlying CPU architecture and the I/O map might be hard. But these are special cases and do not apply to majority of software, that usually is not obfuscated at all.<br /><br />It seems like the argument of Backdoored Proprietary Software usually comes from the open-source people, who are used to unlimited accesses to the source code, and consequently do not usually have much experience with advanced reverse engineer techniques, simply because they do not need them in their happy "Open Source Life". It's all Darwinism, after all ;)<br /><br />On the other hand, some things are hard to analyze, regardless of whether the source code is available or not, think: crypto. Also, how many of you who actively use open source crypto software, e.g. TrueCrypt or GnuPG, have actually reviewed the source code? Anyone?<br /><br />You might be thinking — maybe I haven't looked at the source code myself, but because it is open source, <span style="font-style: italic;">zillions</span> of other users already have reviewed it. And if there was some backdoor in there, they would undoubtedly have found it already! Well, for all those open source fetishists, who blindly negate the value of anything that is not open source, I have only one word to say: <a href="http://metasploit.com/users/hdm/tools/debian-openssl/">Debian</a>.<br /><br /><span style="font-weight: bold;">Keep in mind:</span> I do not say closed source is more secure than open source — I only resist the open-source fundamentalism, that defines every proprietary software as inherently insecure, and everything open source as ultimately secure.<br /><br />So, how should one (e.g. a government institution) verify security-level of a given crypto software, e.g. to ensure there are no built-in backdoors in there? I personally doubt it could be performed by one team, as it just usually happens that the same people who might be exceptionally skilled in code review, system-level security, etc, at the same time are average cryptographers and vice-versa.<br /><br />Imagine e.g. that you need to find out if there are any weaknesses in your system drive encryption software, something like BitLocker. Even if you get access to the source code, you still would have to analyze a lot of system-level details — how is the trusted boot implemented (SRTM? DRTM? TPM interaction?), which system software is trusted, how the implementation withstands various not-crypto-related attacks (e.g. some of the attacks I described in my <a href="http://theinvisiblethings.blogspot.com/2009/01/why-do-i-miss-microsoft-bitlocker.html">previous post</a>), etc…<br /><br />But this all is just system-level evaluation. What should come later is to analyze the actual crypto algorithms and protocols. Those later tasks fall into cryptography field and not into system-level security discipline, and consequently should be performed by some other team, the crypto experts.<br /><br />So, no doubt, it is not an easy task, and the fact if there is or there is not C/C++ source code available, is usually one of the minor headaches (a good example is our <a href="http://theinvisiblethings.blogspot.com/2009/01/attacking-intel-trusted-execution.html">attack on TXT</a>, where we were able to discover bugs in Intel's <span style="font-style: italic;">specific system software</span>, which, of course, is not open source).