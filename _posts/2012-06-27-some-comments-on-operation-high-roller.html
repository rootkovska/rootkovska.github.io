---
layout: post
title: Some comments on "Operation High Roller"
date: '2012-06-27T16:00:00.003+02:00'
author: Joanna Rutkowska
tags: 
modified_time: '2012-11-02T18:06:08.839+01:00'
blogger_id: tag:blogger.com,1999:blog-24586388.post-7366669906499592065
blogger_orig_url: http://theinvisiblethings.blogspot.com/2012/06/some-comments-on-operation-high-roller.html
---

About a year ago I wrote about <a href="/2011/04/16/why-us-password-revolution-wont-work.html">Why the US "password revolution" won't work</a>, where I pointed out that a massive move towards two-factor authentication will <i>not</i> solve any of the identity theft problems that users experience today. Specifically, I wrote:<br /><blockquote class="tr_bq">[People] don't understand that the [compromised] <i>operating system can impersonate the user at will</i>! </blockquote><blockquote class="tr_bq">The compromised OS could have saved your PIN to this [smart] card when you used  it previously (even if you configured it not to do so!) and now,&nbsp;  immediately, it could use the inserted card to authenticate <i>as you</i> to the bank and start issuing transactions on your behalf. And you  won't even notice this all, because in the meantime it will show you a  faked screen of your banking account. After all, it fully controls the  screen.</blockquote><blockquote class="tr_bq">The bottom line is that <b>we cannot secure our digital lives, if our client operating systems could not be secured first</b>. </blockquote><blockquote class="tr_bq"><b>But introduction of tokens won't make our  operating systems any more secure</b>!</blockquote><br />This article sparked lots of controversy with many people, who considered it a fallacy to criticize two factor authentication...<br /><br />Today, I came across the news about <i>Operation High Roller</i>, discovered recently by McAfee and Guardian Analytics. They <a href="http://www.mcafee.com/us/resources/reports/rp-operation-high-roller.pdf">released a paper</a> with some details about the attacks and the malware deployed. Some interesting quotes:<br /><blockquote class="tr_bq"><b>All of the instances that involved High Roller malware could bypass complex multi-stage authentication.</b> Unlike recent attacks that collect simple form authentication data—a security challenge question, a one-time token, or PIN—this attack can get past the extensive physical (“something you have”) authentication required by swiping a card in a reader and typing the input into a field (see Two-factor Authentication sidebar).</blockquote><blockquote class="tr_bq">The attack asks the victim to supply the information required to get around the physical controls of smartcard reader plus pin pad entry to generate a one-time password (or digital token). </blockquote><blockquote class="tr_bq">Having collected all the information it requires for the entire transfer, the malware stalls the user and executes its transaction in the background using the legitimate digital token.</blockquote><blockquote class="tr_bq">Multiple after-the-theft behaviors hide evidence of the transaction from the user. For example, the client-side malware kills the links to printable statements. It also searches for and erases confirmation<br />emails and email copies of the statement. Finally, it also changes the transactions, transaction values, and account balance in the statement displayed on the victim’s screen so the amounts are what the account holder expects to see.</blockquote><br />Defensive security is a difficult game, because one doesn't immediately see whether a given solution works or not. This is in stark contrast to other engineering disciplines (and to offensive security) where one usually have immediate feedback on whether something works well or not.<br /><br />Say you want to build a redundant long-range video downlink for your unmanned, remotely operated helicopter -- you can throw in lots of money buying various high-gain antennas, circular antennas, antenna trackers, diversity systems, etc., but then ultimately you can verify your creation immediately by going into a field and trying to fly a few miles away, and see whether you loose the vision (usually in the middle of some life-threatening manoeuvre) or not. At least you can draw some lines of how good your solution is ("I can fly up to one mile away, but not more, unless there aren't that many trees around and the air is dry enough").<br /><br />With security, especially with computer security, it is so different, because there is no immediate feedback. This results in various vendors pitching their products as wonderful solutions that just solve all the worlds problems, even though what they're saying <a href="http://www.bromium.com/misc/BromiumMicrovirtualization.pdf">in those marketing materials</a> might be pure nonsense... (BTW, congrats to Simon Crosby for <a href="http://www.wired.com/wiredenterprise/2012/06/crosby-bromium-microvisor/all/">apparently creating a Windows-hosted VMM in below 10k LOC!</a> ;)<br /><br />The often made mistake is to say: "Perhaps there is a way to attack this solution, but then again, how much of the malware <i>in the wild</i> implements such attacks?" This is a classical thinking in our industry, and in my opinion, an inexcusable mistake! Let me say it clearly:<br /><br /><div style="text-align: center;"><b>It doesn't matter whether what the malware in the wild does -- it matters what it <i>could </i>potentially do!</b></div><br />So, if we can do a quick brainstorming session and point out potential attacks within 1 hour against some technology/product X, then, if we don't see a solution how to prevent them generically, we should not bother and implement product X, because it <i>will</i> be defeated, sooner or later. Let's not waste time on useless solutions, life's too short!