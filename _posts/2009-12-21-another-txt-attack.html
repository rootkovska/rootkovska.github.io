---
layout: post
title: Another TXT Attack
date: '2009-12-21T19:11:00.005+01:00'
author: Joanna Rutkowska
tags:
- attack
- trusted execution technology
- trusted computing
- exploit
modified_time: '2010-01-16T12:25:46.578+01:00'
thumbnail: http://4.bp.blogspot.com/_Ti3q3Hdvels/Sy-7Sx0fLlI/AAAAAAAAAGA/MvXTpW6ZTTQ/s72-c/broken+chain.jpg
blogger_id: tag:blogger.com,1999:blog-24586388.post-7396711639241642204
blogger_orig_url: http://theinvisiblethings.blogspot.com/2009/12/another-txt-attack.html
---

<img style="float:right; margin:0 0 10px 10px;cursor:pointer; cursor:hand;width: 200px; height: 148px;" src="http://4.bp.blogspot.com/_Ti3q3Hdvels/Sy-7Sx0fLlI/AAAAAAAAAGA/MvXTpW6ZTTQ/s200/broken+chain.jpg" border="0" alt=""id="BLOGGER_PHOTO_ID_5417754808035520082" />Earlier this year our team has <a href="http://invisiblethingslab.com/press/itl-press-2009-02.pdf">presented</a> an attack against Intel TXT that exploited a design problem with SMM mode being over privileged on PC platforms and able to interfere with the SENTER instruction. The Intel response was two-fold: to <a href="http://security-center.intel.com/advisory.aspx?intelid=INTEL-SA-00018&languageid=en-fr">patch</a> the SMM implementation bugs we used for the attack (this patch was for both the NVACPI SMM attacks, as well as for the <a href="/2009/03/19/attacking-smm-memory-via-intel-cpu.html">SMM caching attack</a>), and also to start (intensify?) working on STM specification, that is, we heard, planned to be published sometime in the near future. STM is a thin hypervisor concept that is supposed to provide protection against (potentially) malicious SMMs.<br /><br />Today we present a totally different attack that allows an attacker to trick the SENTER instruction into misconfiguring the VT-d engine, so that it doesnâ€™t protect the newly loaded hypervisor or kernel. This attack exploits an implementation flaw in a SINIT AC module. This new attack also allows for full TXT circumvention, using a software-only attack. This attack doesn't require any SMM bugs to succeed and is totally independent from the previous one.<br /><br />The press release is <a href="http://invisiblethingslab.com/press/itl-press-2009-04.pdf">here</a>.<br /><br />The full paper is <a href="http://invisiblethingslab.com/resources/misc09/Another%20TXT%20Attack.pdf">here</a>.<br /><br />The advisory published by Intel today can be found <a href="http://security-center.intel.com/advisory.aspx?intelid=INTEL-SA-00021&languageid=en-fr">here</a>.<br /><br />Enjoy.