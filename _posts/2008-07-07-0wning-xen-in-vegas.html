---
layout: post
title: 0wning Xen in Vegas!
date: '2008-07-07T16:03:00.004+02:00'
author: Joanna Rutkowska
tags:
- hypervisor rootkits
- xen hacking
- virtualization based rootkits
modified_time: '2009-03-25T16:03:47.633+01:00'
thumbnail: http://1.bp.blogspot.com/_Ti3q3Hdvels/SHIrRRp7nYI/AAAAAAAAAB8/MCybwCZ2nuI/s72-c/Fotolia_1758548_XS.jpg
blogger_id: tag:blogger.com,1999:blog-24586388.post-5820262464138516969
blogger_orig_url: http://theinvisiblethings.blogspot.com/2008/07/0wning-xen-in-vegas.html
---

<img style="float:right; margin:0 0 10px 10px;" src="http://1.bp.blogspot.com/_Ti3q3Hdvels/SHIrRRp7nYI/AAAAAAAAAB8/MCybwCZ2nuI/s200/Fotolia_1758548_XS.jpg" border="0" alt=""id="BLOGGER_PHOTO_ID_5220282493872872834" />At this year’s Black Hat conference in Las Vegas in August <a href="/2008/07/01/rafal-wojtczuk-joins-invisible-things.html">we</a> will be presenting three talks about the Xen hypervisor (in)security. The three presentations have been designed in such a way that they complement each other and create one bigger entirety, thus they can be referred as <strong>“Xen 0wning Trilogy”</strong> for brevity.<br /><br />In the first presentation, <a href="http://blackhat.com/html/bh-usa-08/bh-usa-08-speakers.html#Wojtczuk">Subverting the Xen hypervisor</a>, Rafal will discuss how to modify the Xen’s hypervisor memory and consequently how to use this ability to plant hypervisor rootkits inside Xen (everything on the fly, without rebooting Xen). Hypervisor rootkits are very different creatures from virtualization based rootkits (e.g. Bluepill). This will be the first public demonstration of practical VMM 0wning (proof of concept code will be released, of course).<br /><br />In the second talk, <a href="http://blackhat.com/html/bh-usa-08/bh-usa-08-speakers.html#Rutkowska">Detecting and Preventing the Xen hypervisor subversions</a>, Rafal and I will discuss various anti-subverting techniques (IOMMU, Xen’s driver- and stub- domains) and whether they really can protect the Xen (or similar) hypervisor from compromises. After demonstrating that those mechanisms can be bypassed, we will switch to discussing hypervisor integrity scanning and will present some prototype solutions to this problem.<br /><br />Our trilogy wouldn’t be complete without discussing virtualization based malware in the context of bare-metal hypervisor compromises. Thus, in the third speech, <a href="http://blackhat.com/html/bh-usa-08/bh-usa-08-speakers.html#Tereshkin">Bluepilling the Xen hypervisor</a>, Alex and I will discuss how to insert Bluepill on top of the running Xen hypervisor. We will show how to do that both with and without restart (i.e. on the fly). To make this possible, our Bluepill needs to support full nested virtualization, so that Xen can still function properly. We will also discuss how the “Bluepill detection” methods proposed over the last 2 years, as well as the integrity scanning methods discussed in the previous speech, fit into this new scenario and how far we are from the stealth malware’s Holy Grail ;)<br /><br />Special thanks to Black Hat organizers for scheduling all the three presentations one after another in a dedicated <em>Virtualization</em> track on the 2nd day of the conference (August 7th).<br /><br />It’s worth noting that we chose Xen as the target not because we think it’s insecure and worthless. On the contrary, we believe Xen is the most secure bare-metal hypervisor out there (especially with all the goodies in the upcoming Xen 3.3). Still we believe that it needs some improvements when it comes to security. We hope that our presentations will help making Xen (and similar hypervisors) more secure.